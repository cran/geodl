<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Model Assessment</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Model Assessment</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geodl)</span></code></pre></div>
<div id="terminology-and-metrics" class="section level2">
<h2>Terminology and Metrics</h2>
<p>Accuracy assessment is an important component of the modeling
process. Specifically, it is important to assess your model against
withheld data. Assessing the model relative to the training samples can
be misleading due to issue of overfitting. As a result, using a
withheld, randomized, unbiased test set to assess the final model is
important to quantify how well the model generalizes to new data, which
is generally the point of creating a model. Before we begin, here are a
few notes on key terminology:</p>
<ul>
<li><strong>Training Set</strong>: samples used to update model
parameters. These samples are used to calculated the loss and guide the
model parameter updates as the mini-batches are processed.</li>
<li><strong>Validation Set</strong>: data used to assess the model at
the end of each training epoch during the training process. It is common
to select the model that provides the best results relative to the
validation data and as measured using an assessment metric. The model
that provides the best performance for the training data may not be the
best model do to overfitting.</li>
<li><strong>Test Set</strong>: data used to assess the final selected
model.</li>
</ul>
<p>In this example, we are primarily interested in the test set. Once a
final model is generated, it can be used to predict to a test set. The
test set labels can be compared to the predictions to generated a
<strong>confusion matrix</strong> and associated assessment metrics.</p>
<p>An example confusion matrix is shown below. <strong>geodl</strong>
uses the confusion matrix configuration standard within the field of
remote sensing where the columns represent the reference labels and the
rows represent the predictions. In the example confusion matrix, 50
samples were predicted to Class A and were correctly predicted as Class
A. 8 samples were examples of Class A but were incorrectly predicted as
Class B. 10 samples were examples of Class B what were incorrectly
labeled as Class A. Relative to Class A, the 8 samples there were
mislabeled to Class B would represent omission errors: they were
incorrectly omitted from Class A. In contrast, the 10 reference samples
that were from Class B but incorrectly predicted to Class A would be
examples of commission error relative to Class A: they were incorrectly
included in Class A.</p>
<p>In short, the confusion matrix describes not just the overall amount
of error, but differentiates the types of errors. This allows analysts
and users to understand which classes were most commonly confused or
which classes were most difficult to map or differentiate.</p>
<p><span class="math display">\[
\begin{array}{c|ccc}
&amp; \text{Reference A} &amp; \text{Reference B} &amp; \text{Reference
C} \\
\hline
\text{Prediction A} &amp; 50 &amp; 10 &amp; 5 \\
\text{Prediction B} &amp; 8 &amp; 45 &amp; 7 \\
\text{Prediction C} &amp; 2 &amp; 5 &amp; 60 \\
\end{array}
\]</span></p>
<p><strong>Overall accuracy</strong> represents the percentage or
proportion of the total samples that were correctly predicted.</p>
<p><span class="math display">\[
\text{Accuracy} = \frac{\text{Number of Correct
Predictions}}{\text{Total Number of Predictions}}
\]</span></p>
<p>Outside of an aggregated overall accuracy, it can be useful to report
class-level metrics. In remote sensing 1 - omission error for a class is
generally termed <strong>producer’s accuracy</strong> while 1 -
commission error is termed <strong>user’s accuracy</strong>. When the
confusion matrix is configured such that the reference labels define the
columns and the predictions define the rows, producer’s accuracy is
calculated as the number correct for the class divided by the column
total while user’s accuracy is calculated as the number correct for the
class divided by the associated row total.</p>
<p><span class="math display">\[
\text{Producer&#39;s Accuracy (PA)}\_i = \frac{\text{Number of Correctly
Classified Samples of Class } i}{\text{Total Number of Reference Samples
of Class } i}
\]</span></p>
<p><span class="math display">\[
\text{User&#39;s Accuracy (UA)}\_i = \frac{\text{Number of Correctly
Classified Samples of Class } i}{\text{Total Number of Samples
Classified as Class } i}
\]</span></p>
<p>For a binary classification problem where one class is the positive
case or case of interest and the other class is the background or
negative case, it is common to use different terminology. The confusion
matrix below represents a binary confusion matrix. Here is an
explanation of the associated terminology:</p>
<ul>
<li><strong>TP</strong>: True Positive (positive case sample that was
correctly predicted as positive)</li>
<li><strong>TN</strong>: True Negative (negative case sample that was
correctly predicted as negative)</li>
<li><strong>FP</strong>: False Positive (negative case sample that was
incorrectly labeled as positive)</li>
<li><strong>FN</strong>: False Negative (positive case sample that was
incorrectly labeled as negative)</li>
</ul>
<p><span class="math display">\[
\begin{array}{c|cc}
&amp; \text{Reference Positive} &amp; \text{Reference Negative} \\
\hline
\text{Prediction Positive} &amp; TP &amp; FP \\
\text{Prediction Negative} &amp; FN &amp; TN \\
\end{array}
\]</span></p>
<p>From the binary confusion matrix, we can calculate overall accuracy
as stated above. Overall accuracy can also be defined relative to TP,
TN, FN, and FP counts as follows:</p>
<p><span class="math display">\[
\text{Accuracy} = \frac{\text{TP} + \text{TN}}{\text{TP} + \text{TN} +
\text{FP} + \text{FN}}
\]</span></p>
<p>At the class-level, <strong>recall</strong> for each class can be
calculated using the TP and FN counts. Recall is equivalent to
class-level producer’s accuracy and quantifies 1 - omission error
relative to the positive case.</p>
<p><span class="math display">\[
\text{Recall} = \frac{\text{TP}}{\text{TP} + \text{FN}}
\]</span></p>
<p>Class-level <strong>precision</strong> quantifies 1 - commission
error and is equivalent to user’s accuracy for the positive case. It is
calculated using the TP and FP counts.</p>
<p><span class="math display">\[
\text{Precision} = \frac{\text{TP}}{\text{TP} + \text{FP}}
\]</span></p>
<p>Precision and recall can be combined to a single class-level metric
as the <strong>F1-score</strong>, which is the harmonic mean of
precision and recall. It can be stated relative to precision and recall
or relative to TP, FP, and FN counts.</p>
<p><span class="math display">\[
F1 = 2 \cdot \frac{\text{Precision} \cdot
\text{Recall}}{\text{Precision} + \text{Recall}}
\]</span></p>
<p><span class="math display">\[
F1 = 2 \cdot \frac{TP}{2TP + FP + FN}
\]</span></p>
<p>For the negative or background class, <strong>specificity</strong>
represents 1 - omission error while <strong>negative predictive value
(NPV)</strong> represents 1 - commission error.</p>
<p><span class="math display">\[
\text{Specificity} = \frac{TN}{TN + FP}
\]</span> <span class="math display">\[
\text{NPV} = \frac{TN}{TN + FN}
\]</span></p>
<p>Lastly, it might be of interest to aggregate class-level metrics.
There are three general ways to do this. *
<strong>macro-averaging</strong>: calculate the metric separately for
each class then take the average such that each class is equally
weighted in the aggregated metric.</p>
<ul>
<li><p><strong>micro-averaging</strong>: aggregate TP, TN, FP, and FN
counts and calculate a single metric such that more abundant classes
have a larger weight in the final calculation.</p></li>
<li><p><strong>weighted macro-averaging</strong>: calculate a
macro-average with user-specified class weights such that the classes
are not equally weighted.</p></li>
</ul>
<p>For a multiclass problem, micro-averaged user’s accuracy (precision)
and producer’s accuracy (recall) are equivalent to each other and also
equivalent to overall accuracy and the micro-averaged F1-score. So,
there is no need to calculate micro-averaged metrics if overall accuracy
is reported. Instead, it makes more sense to report overall accuracy,
macro-averaged class metrics, and non-aggregated class metrics. This is
the method used within <strong>geodl</strong>.</p>
</div>
<div id="example-1-multiclass-classification" class="section level2">
<h2>Example 1: Multiclass Classification</h2>
<p>In this first example, geodl’s <em>assessPnts()</em> function is used
to calculate assessment metrics for a multiclass classification from a
table or at point locations. The “ref” column represents the reference
labels while the “pred” column represents the predictions. The
<em>mappings</em> parameter allows for providing more meaningful class
names and is especially useful when classes are represented using
numeric codes.</p>
<p>For a multiclass assessment, the following are returned: class names
($Classes), count of samples per class in the reference data
($referenceCounts), count of samples per class in the predictions
($predictionCounts), confusion matrix ($confusionMatrix), aggregated
assessment metrics ($aggMetrics) (OA = overall accuracy, macroF1 =
macro-averaged class aggregated F1-score, macroPA = macro-averaged class
aggregated producer’s accuracy or recall, and macroUA = macro-averaged
class aggregated user’s accuracy or precision), class-level user’s
accuracies or precisions ($userAccuracies), class-level producer’s
accuracies or recalls ($producerAccuracies), and class-level F1-scores
($F1Scores).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mcIn <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;C:/myFiles/data/tables/multiClassExample.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>myMetrics <span class="ot">&lt;-</span> <span class="fu">assessPnts</span>(<span class="at">reference=</span>mcIn<span class="sc">$</span>ref,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">predicted=</span>mcIn<span class="sc">$</span>pred,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">multiclass=</span><span class="cn">TRUE</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mappings=</span><span class="fu">c</span>(<span class="st">&quot;Barren&quot;</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Forest&quot;</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Impervous&quot;</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Low Vegetation&quot;</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Mixed Developed&quot;</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Water&quot;</span>))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(myMetrics)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>Classes</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;Barren&quot;</span>          <span class="st">&quot;Forest&quot;</span>          <span class="st">&quot;Impervous&quot;</span>       <span class="st">&quot;Low Vegetation&quot;</span>  <span class="st">&quot;Mixed Developed&quot;</span> <span class="st">&quot;Water&quot;</span>          </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>referenceCounts</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>         Barren          Forest       Impervous  Low Vegetation Mixed Developed           Water </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>            <span class="dv">163</span>           <span class="dv">20807</span>             <span class="dv">426</span>            <span class="dv">3182</span>             <span class="dv">520</span>             <span class="dv">200</span> </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>predictionCounts</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>         Barren          Forest       Impervous  Low Vegetation Mixed Developed           Water </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>            <span class="dv">194</span>           <span class="dv">21440</span>             <span class="dv">281</span>            <span class="dv">2733</span>             <span class="dv">484</span>             <span class="dv">166</span> </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>confusionMatrix</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>                 Reference</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>Predicted         Barren Forest Impervous Low Vegetation Mixed Developed Water</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  Barren              <span class="dv">75</span>      <span class="dv">7</span>        <span class="dv">59</span>             <span class="dv">46</span>               <span class="dv">1</span>     <span class="dv">6</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  Forest              <span class="dv">13</span>  <span class="dv">20585</span>        <span class="dv">62</span>            <span class="dv">617</span>             <span class="dv">142</span>    <span class="dv">21</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  Impervous           <span class="dv">10</span>      <span class="dv">8</span>       <span class="dv">196</span>             <span class="dv">33</span>              <span class="dv">22</span>    <span class="dv">12</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  Low Vegetation      <span class="dv">63</span>    <span class="dv">138</span>        <span class="dv">34</span>           <span class="dv">2413</span>              <span class="dv">84</span>     <span class="dv">1</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  Mixed Developed      <span class="dv">1</span>     <span class="dv">64</span>        <span class="dv">75</span>             <span class="dv">72</span>             <span class="dv">270</span>     <span class="dv">2</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  Water                <span class="dv">1</span>      <span class="dv">5</span>         <span class="dv">0</span>              <span class="dv">1</span>               <span class="dv">1</span>   <span class="dv">158</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>aggMetrics</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>      OA macroF1 macroPA macroUA</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="fl">0.9367</span>  <span class="fl">0.6991</span>  <span class="fl">0.6629</span>  <span class="fl">0.7395</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>userAccuracies</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>         Barren          Forest       Impervous  Low Vegetation Mixed Developed           Water </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0.3866</span>          <span class="fl">0.9601</span>          <span class="fl">0.6975</span>          <span class="fl">0.8829</span>          <span class="fl">0.5579</span>          <span class="fl">0.9518</span> </span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>producerAccuracies</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>         Barren          Forest       Impervous  Low Vegetation Mixed Developed           Water </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0.4601</span>          <span class="fl">0.9893</span>          <span class="fl">0.4601</span>          <span class="fl">0.7583</span>          <span class="fl">0.5192</span>          <span class="fl">0.7900</span> </span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>f1Scores</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>         Barren          Forest       Impervous  Low Vegetation Mixed Developed           Water </span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0.4202</span>          <span class="fl">0.9745</span>          <span class="fl">0.5545</span>          <span class="fl">0.8159</span>          <span class="fl">0.5378</span>          <span class="fl">0.8634</span> </span></code></pre></div>
</div>
<div id="example-2-binary-classification" class="section level2">
<h2>Example 2: Binary Classification</h2>
<p>A binary classification can also be assessed using the
<em>assessPnts()</em> function and a table or point locations. For a
binary classification the <em>multiclass</em> parameter should be set to
FALSE. For a binary case, the $Classes,
$referenceCounts,$predictionCounts, and $confusionMatrix objects are
also returned; however, the $aggMets object is replaced with $Mets,
which stores the following metrics: overall accuracy, recall, precision,
specificity, negative predictive value (NPV), and F1-score. For binary
cases, the second class is assumed to be the positive case.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>bIn <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;C:/myFiles/data/tables/binaryExample.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>myMetrics <span class="ot">&lt;-</span> <span class="fu">assessPnts</span>(<span class="at">reference=</span>bIn<span class="sc">$</span>ref,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">predicted=</span>bIn<span class="sc">$</span>pred,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">multiclass=</span><span class="cn">FALSE</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mappings=</span><span class="fu">c</span>(<span class="st">&quot;Not Mine&quot;</span>, <span class="st">&quot;Mine&quot;</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(myMetrics)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>Classes</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;Not Mine&quot;</span> <span class="st">&quot;Mine&quot;</span>    </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>referenceCounts</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>Negative Positive </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4822</span>      <span class="dv">178</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>predictionCounts</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>Negative Positive </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4840</span>      <span class="dv">160</span> </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>ConfusionMatrix</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>          Reference</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>Predicted  Negative Positive</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  Negative     <span class="dv">4820</span>       <span class="dv">20</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  Positive        <span class="dv">2</span>      <span class="dv">158</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>Mets</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>         OA Recall Precision Specificity    NPV F1Score</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>Mine <span class="fl">0.9956</span> <span class="fl">0.8876</span>    <span class="fl">0.9875</span>      <span class="fl">0.9996</span> <span class="fl">0.9959</span>  <span class="fl">0.9349</span></span></code></pre></div>
</div>
<div id="example-3-extract-raster-data-at-points" class="section level2">
<h2>Example 3: Extract Raster Data at Points</h2>
<p>Before using the <em>assessPnts()</em> function, you may need to
extract predictions into a table. This example demonstrates how to
extract reference and prediction numeric codes from raster grids at
point locations. Note that it is important to make sure all data layers
use the same projection or coordinate reference system. The
<em>extract()</em> function from the <strong>terra</strong> packages can
be used to extract raster call values at point locations.</p>
<p>Once data are extracted, the <em>assessPnts()</em> tool can be used
with the resulting table. It may be useful to recode the class numeric
codes to more meaningful names beforehand.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pntsIn <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">vect</span>(<span class="st">&quot;C:/myFiles/data/topoResult/topoPnts.shp&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>refG <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">&quot;C:/myFiles/data/topoResult/topoRef.tif&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>predG <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">&quot;C:/myFiles/data/topoResult/topoPred.tif&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pntsIn2 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">project</span>(pntsIn, terra<span class="sc">::</span><span class="fu">crs</span>(refG))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>refIsect <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">extract</span>(refG, pntsIn2)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>predIsect <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">extract</span>(predG, pntsIn2)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>resultsIn <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ref=</span><span class="fu">as.factor</span>(refIsect<span class="sc">$</span>topoRef),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">pred=</span><span class="fu">as.factor</span>(predIsect<span class="sc">$</span>topoPred))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>resultsIn<span class="sc">$</span>ref <span class="ot">&lt;-</span> forcats<span class="sc">::</span><span class="fu">fct_recode</span>(resultsIn<span class="sc">$</span>ref,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Not Mine&quot;</span> <span class="ot">=</span> <span class="st">&quot;0&quot;</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Mine&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>resultsIn<span class="sc">$</span>pred <span class="ot">&lt;-</span> forcats<span class="sc">::</span><span class="fu">fct_recode</span>(resultsIn<span class="sc">$</span>pred,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Not Mine&quot;</span> <span class="ot">=</span> <span class="st">&quot;0&quot;</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Mine&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>myMetrics <span class="ot">&lt;-</span> <span class="fu">assessPnts</span>(<span class="at">reference=</span>bIn<span class="sc">$</span>ref,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">predicted=</span>bIn<span class="sc">$</span>pred,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">multiclass=</span><span class="cn">FALSE</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mappings=</span><span class="fu">c</span>(<span class="st">&quot;Not Mine&quot;</span>, <span class="st">&quot;Mine&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(myMetrics)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>Classes</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;Not Mine&quot;</span> <span class="st">&quot;Mine&quot;</span>    </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>referenceCounts</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>Negative Positive </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4822</span>      <span class="dv">178</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>predictionCounts</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>Negative Positive </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4840</span>      <span class="dv">160</span> </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>ConfusionMatrix</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>          Reference</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>Predicted  Negative Positive</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  Negative     <span class="dv">4820</span>       <span class="dv">20</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  Positive        <span class="dv">2</span>      <span class="dv">158</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>Mets</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>         OA Recall Precision Specificity    NPV F1Score</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>Mine <span class="fl">0.9956</span> <span class="fl">0.8876</span>    <span class="fl">0.9875</span>      <span class="fl">0.9996</span> <span class="fl">0.9959</span>  <span class="fl">0.9349</span></span></code></pre></div>
</div>
<div id="example-4-use-rasters-grids-as-opposed-to-point-locations" class="section level2">
<h2>Example 4: Use Rasters Grids as Opposed to Point Locations</h2>
<p>The <em>assessRaster()</em> function allows for calculating
assessment metrics from reference and prediction categorical raster
grids as opposed to point locations or tables. Note that the grids being
compared should have the same spatial extent, coordinate reference
system, and number of rows and columns of cells.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>refG <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">&quot;C:/myFiles/data/topoResult/topoRef.tif&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>predG <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">&quot;C:/myFiles/data/topoResult/topoPred.tif&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>refG2 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">crop</span>(terra<span class="sc">::</span><span class="fu">project</span>(refG, predG), predG)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>myMetrics <span class="ot">&lt;-</span> <span class="fu">assessRaster</span>(<span class="at">reference =</span> refG2,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">predicted =</span> predG,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">multiclass =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mappings =</span> <span class="fu">c</span>(<span class="st">&quot;Not Mine&quot;</span>, <span class="st">&quot;Mine&quot;</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(myMetrics)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>Classes</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;Not Mine&quot;</span> <span class="st">&quot;Mine&quot;</span>    </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>referenceCounts</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>Negative Positive </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="dv">36022015</span>  <span class="dv">1301194</span> </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>predictionCounts</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>Negative Positive </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="dv">36146932</span>  <span class="dv">1176277</span> </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>ConfusionMatrix</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>          Reference</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>Predicted  Negative Positive</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  Negative <span class="dv">35994704</span>   <span class="dv">152228</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  Positive    <span class="dv">27311</span>  <span class="dv">1148966</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="sc">$</span>Mets</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>         OA Recall Precision Specificity    NPV F1Score</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>Mine <span class="fl">0.9952</span>  <span class="fl">0.883</span>    <span class="fl">0.9768</span>      <span class="fl">0.9992</span> <span class="fl">0.9958</span>  <span class="fl">0.9275</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
